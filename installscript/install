#!/bin/bash

# Start and Enable NetworkManager
sudo systemctl enable NetworkManager.service --now

# Install paru
pacman -S --noconfirm rust
git clone https://aur.archlinux.org/paru.git
cd paru
makepkg -si
cd ..
pacman -R --noconfirm rust

# Get base dependencies
paru -S --needed --noconfirm \
asdf-vm \
base-devel openssl zlib xz git \
spotify-tui spotifyd zsh tmux neovim neofetch fzf fzy exa\
flameshot firefox discord \
code \
gtk-engine-murrine gtk-engines 

# Update existing packages and sources
paru --noconfirm

# Install Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh


## APP SETUP
# Set up ASDF
. /opt/asdf-vm/asdf.sh
asdf plugin-add dotnet-core https://github.com/emersonsoares/asdf-dotnet-core.git
asdf plugin-add python
asdf plugin-add rust https://github.com/code-lever/asdf-rust.git
asdf plugin-add nodejs
asdf plugin-add java https://github.com/halcyon/asdf-java.git

# Set up ZSH
chsh -s /bin/zsh

# Download base16
git clone https://github.com/chriskempson/base16-shell.git $HOME/.config/base16-shell

# Download safe-rm
mkdir $HOME/.local/bin
curl -L https://raw.githubusercontent.com/kaelzhang/shell-safe-rm/master/bin/rm.sh > $HOME/.local/bin/safe-rm

# Configure tmux
git clone https://github.com/tmux-plugins/tpm $HOME/.tmux/plugins/tpm

# Configure neovim
sh -c 'curl -fLo "${XDG_DATA_HOME:-$HOME/.local/share}"/nvim/site/autoload/plug.vim --create-dirs \
       https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'

# Configure VSCode
code --install-extension ms-python.python


## THEMING
# Download Themes
wget -c https://github.com/EliverLara/Nordic/releases/latest/download/Nordic.tar.xz -O - | sudo tar -xJ -C /usr/share/themes
sudo git clone https://github.com/FadeMind/manjarin-gtk-theme.git /usr/share/themes/manjarin
wget -c https://github.com/dracula/gtk/releases/latest/download/Dracula.tar -O - | sudo tar -xJ -C /usr/share/themes

# Download Icon Themes
wget -qO- https://git.io/papirus-icon-theme-install | sh
wget -c https://github.com/dracula/gtk/files/5214870/Dracula.zip -O - | sudo unzip -d /usr/share/icons

# Set GNOME preferences
gsettings set org.gnome.desktop.wm.preferences theme "Dracula"
gsettings set org.gnome.desktop.interface gtk-theme "Dracula"
gsettings set org.gnome.desktop.interface icon-theme "Dracula"
gsettings set org.gnome.desktop.peripherals.touchpad tap-to-click true
gsettings set org.gnome.desktop.peripherals.touchpad tap-and-drag-lock true
gsettings set org.gnome.desktop.wm.preferences button-layout 'appmenu:minimize,maximize,close'

# Set GNOME shortcuts
dconf load / < keybindings

echo "Please reboot now"
